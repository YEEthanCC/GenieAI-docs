# 列表操作

文件列表變量支持同時上傳文檔文件、圖片、音頻與視頻文件等多種文件。應用使用者在上傳文件時，所有文件都存儲在同一個 ```Array[File]``` 數組類型變量內，**不利於後續單獨處理文件**。列表操作節點可以在數組變量內提取單獨的元素，便於後續節點處理。

```Array```數據類型意味著該變量的實際值可能為 [1.mp3, 2.png, 3.doc]，大語言模型（LLM）僅支持讀取圖片文件或文本內容等單一值作為輸入變量，無法直接讀取數組變量，通常需要配合列表操作節點一起使用。

## 節點功能
列表操作節點可以對文件的格式類型、文件名、大小等屬性進行過濾與提取，將不同格式的文件傳遞給對應的處理節點，以實現對不同文件處理流的精確控制。

例如在一個應用中，允許用戶同時上傳文檔文件和圖片文件兩種不同類型的文件。需要使用列表操作節點進行分揀，將不同的文件類型交由不同流程處理。

![list-operation-node](/工作流程/節點說明/images/list-operation-node.png)

列表操作节点一般用于提取数组变量中的信息，通过设置条件将其转化为能够被下游节点所接受的变量类型。它的结构分为**输入变量、过滤条件、排序（可选）、取前 N 项（可选）、输出变量**。

![list-operation-node-config](/工作流程/節點說明/images/list-operation-node-config.png)

## 輸入變量

列表操作節點僅接受以下數據結構變量：

- Array[string]
- Array[number]
- Array[file]

## 過濾條件
處理輸入變量中的數組，添加過濾條件。從數組中分揀所有滿足條件的數組變量，可以理解為對變量的屬性進行過濾。

舉例：文件中可能包含多重維度的屬性，例如文件名、文件類型、文件大小等屬性。過濾條件允許設置篩選條件，選擇並提取數組變量中的特定文件。

支持提取以下變量：

- type 文件類別，包含圖片，文檔，音頻和視頻類
- size 文件大小
- name 文件名
- url 指的是應用使用者通過 URL 上傳的文件，可填寫完整 URL 進行篩選
- extension 文件拓展名
- mime_type MIME 類型是用來標識文件內容類型的標準化字符串。示例: "text/html" 表示 HTML 文檔。
- transfer_method 文件上傳方式，分為本地上傳或通過 URL 上傳

## 排序

提供對於輸入變量中數組的排序能力，支持根據文件屬性進行排序。

- 升序排列

    默認排序選項，按照從小到大排序。對於字母和文本，按字母表順序排列（A - Z）

- 降序排列

    由大到小排序，對於字母和文本，按字母表倒序排列（Z - A）

該選項常用於配合輸出變量中的 first_record 及 last_record 使用。

## 取前 N 項

可以在 1-20 中選值，用途是為了選中數組變量的前 n 項。

## 輸出變量

滿足各項過濾條件的數組元素。過濾條件、排序和限制可以單獨開啟。如果同時開啟，則返回符合所有條件的數組元素。

- Result，過濾結果，數據類型為數組變量。若數組中僅包含 1 個文件，則輸出變量僅包含 1 個數組元素；
- first_record，篩選完的數組的首元素，即 result[0]；
- last_record，篩選完的數組的尾元素，即 result[array.length-1]。

## 配置案例
在文件交互問答場景中，應用使用者可能會同時上傳文檔文件或圖片文件。LLM 僅支持識別圖片文件的能力，不支持讀取文檔文件。此時需要用到 列表操作 節點預處理文件變量的數組，將不同的文件類型並發送至對應的處理節點。編排步驟如下：

1. 開啟 Features 功能，並在文件類型中勾選 “圖片” + “文檔文件” 類型。
2. 添加兩個列表操作節點，在 “過濾” 條件中分別設置提取圖片與文檔變量。
3. 提取文檔文件變量，傳遞至 “文檔提取器” 節點；提取圖片文件變量，傳遞至 “LLM” 節點。
4. 在末尾添加 “直接回覆” 節點，填寫 LLM 節點的輸出變量。

![list-operation-example](/工作流程/節點說明/images/list-operation-example.png)

應用使用者同時上傳文檔文件和圖片後，文檔文件自動分流至文檔提取器節點，圖片文件自動分流至 LLM 節點以實現對於混合文件的共同處理。