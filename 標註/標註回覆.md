# 標註回覆
標註回覆功能透過手動編輯標註為應用提供了可自訂的高品質問答回覆能力。

適用情境：
- **特定領域的客製化回答**：在企業、政府等客服或知識庫問答情境時，對於某些特定問題，服務提供者希望確保系統以明確的結果來回答問題，因此需要在特定問題上客製化輸出結果。例如客製化某些問題的「標準答案」或某些問題「不可回答」。
- **POC 或DEMO 產品快速調優**：在快速搭建原型產品，透過標註回覆實現的客製化回答可以高效率提升問答結果的產生預期，提升顧客滿意度。

標註回復功能相當於提供了另一套檢索增強系統，可以跳過LLM 的生成環節，規避RAG 的生成幻覺問題。

## 使用流程
1. 在開啟標註回覆功能之後，你可以對LLM 對話回覆內容進行標註，你可以將LLM 回覆的高品質答案直接加入為一條標註，也可以根據自己的需求編輯一條高品質答案，這些編輯的標註內容會被持久化保存；
2. 當使用者再次提問類似的問題時，會將問題向量化並查詢中與之相似的標註問題；
3. 如果找到匹配項，則直接返回標註中與問題相對應的答案，不再傳遞至LLM 或RAG 過程進行回應；
4. 如果沒有找到匹配項，則問題繼續常規流程（傳遞至LLM 或RAG）；
5. 關閉標註回覆功能後，系統將不再繼續從標註內配對回覆。

![標註回覆流程](/標註/images/標註回覆流程.png)

## 提示詞編排中開啟標註回覆
進入「應用建置->新增功能」開啟標註回復開關：

![提示詞編排中開啟標註回覆](/標註/images/提示詞編排中開啟標註回覆.png)

開啟時需先設定標註回覆的參數，可設定參數包括：Score 閾值與Embedding 模型

**Score 閾值**：用於設定標註回復的匹配相似度閾值，只有高於閾值分數的標註會被召回。

**Embedding 模型**：用於對標註文字進行向量化，切換模型時會重新產生嵌入。

點選儲存並啟用時，此設定會立即生效，系統將對所有已儲存的標註利用Embedding 模型產生嵌入儲存。

![標註回覆參數設定](/標註/images/標註回覆參數設定.png)

## 在會話調試頁面中添加標註
你可以在調試與預覽頁面直接在模型回應資訊上新增或編輯標註。

![新增標註回覆](/標註/images/新增標註回覆.png)

編輯成你需要的高品質回應並保存。

![編輯標註回覆](/標註/images/編輯標註回覆.png)

再次輸入相同的使用者問題，系統將使用已儲存的標註直接回覆使用者問題。

![透過已儲存的標註回覆用戶問題](/標註/images/透過已儲存的標註回覆用戶問題.png)

## 日誌與標註中開啟標註回覆
進入「應用建置->日誌與標註->標註」開啟標註回復開關：

![日誌與標註中開啟標註回覆](/標註/images/日誌與標註中開啟標註回覆.png)

## 在標註後台設定標註回覆參數
標註回復可設定的參數包括：Score 閾值和Embedding 模型

**Score 閾值**：用於設定標註回復的匹配相似度閾值，只有高於閾值分數的標註會被召回。

**Embedding 模型**：用於對標註文字進行向量化，切換模型時會重新產生嵌入。

![設定標註回覆參數](/標註/images/設定標註回覆參數.png)

## 大量導入標註問答對
在批次匯入功能內，你可以下載標註匯入模板，按模版格式編輯標註問答對，編輯好後在此批次匯入。

![大量導入標註問答對](/標註/images/大量導入標註問答對.png)

## 大量導入標註問答對
透過標註批次匯出功能，你可以一次匯出系統內已儲存的所有標註問答對。

![批量導出標註問答對](/標註/images/批量導出標註問答對.png)

## 查看標註回復命中歷史
在標註命中歷史功能內，你可以查看所有命中該條標註的編輯歷史、命中的用戶問題、回复答案、命中來源、匹配相似分數、命中時間等信息，你可以根據這些系統信息持續改進你的標註內容。

![標註回覆命中歷史](/標註/images/標註回覆命中歷史.png)