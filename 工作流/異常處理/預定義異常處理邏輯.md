以下四種類型的節點提供應對異常情況的預處理邏輯編排能力：

- [LLM](https://docs.dify.ai/zh-hans/guides/workflow/node/llm)

- [HTTP](https://docs.dify.ai/zh-hans/guides/workflow/node/http-request)

代碼

工具

異常處理機制提供以下三種預定義編排邏輯選項：

• **無**：不處理異常，直接拋出節點的報錯信息並中斷整體流程。

• **默認值**：允許開發者預定義異常信息。異常發生後，使用預定義的值替代原節點內置的異常輸出信息。

• **異常分支**：發生異常後，執行預編排的異常分支。

![異常處理](/工作流/異常處理/images/異常處理.png)

## 處理邏輯：無

節點異常處理機制的默認選項。如果當前節點的運行狀態超時或遇到錯誤，則直接拋出節點內置的報錯信息，中斷所有流程，工作流應用記錄為運行失敗。

## 處理邏輯：默認值

允許開發者通過默認值編輯器自定義節點的報錯輸出信息，類似編程中常見的單步調試方法，為應用的調試過程提供更加清晰的說明。

例如：

- 對於 ```object``` 和 ```array``` 類型，系統提供直觀的 JSON 編輯器
- 對於 ```number``` 和 ```string``` 類型，則提供對應的類型編輯器。

當節點運行失敗時，流程會自動使用開發者預設的默認值替代原節點輸出的異常信息，確保流程不中斷。更加清晰的報錯信息能夠提升故障的處理效率，讓開發者能夠專注於優化應用的流程設計。

*預設默認值的數據結構類型與節點的輸出變量相一致。例如在代碼節點中，設置節點的輸出變量為 ```array[number]``` 數據類型，則默認值的數據類型也同樣為 ```array[number]``` 數據類型。*

![異常處理默認值](/工作流/異常處理/images/異常處理默認值.png)

## 處理邏輯：異常分支
如果當前節點運行異常，則觸發預設的下遊分支。選擇該處理邏輯後，將為當前節點提供新的連線位，開發者可以在畫布上繼續編排接下來的運行流程，或點擊節點詳情右下角添加下遊節點。例如連接郵件工具節點發送異常信息。

異常分支以橙色線條高亮顯示。

![異常分支](/工作流/異常處理/images/異常分支.png)

一個常見的編排策略是在異常分支內引入應對錯誤情況的處理節點，將修正後的內容通過變量聚合節點鏈接至原分支，匯總輸出結果。

## 異常變量

在節點的異常處理機制中選擇默認值或異常分支邏輯選項後，當前節點在遇到異常情況時將通過 error_type 和 error_message 異常變量將報錯信息傳遞給下遊節點。

|變量名稱|功能描述|
|-------|-------|
|```error_type```|錯誤類型。不同類型的節點有著不同的錯誤類型，開發者可以根據不同的錯誤標識編排對應方案。|
|```error_message```|錯誤信息，異常節點輸出的具體故障信息。開發者可以傳遞給下遊的 LLM 節點進行修覆，或連接郵箱工具推送信息。|
