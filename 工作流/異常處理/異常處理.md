# 異常處理

工作流應用通常包含多個節點。如果因為某個節點的異常（例如 API 請求異常或 LLM 輸出異常）而造成整個流程的運行失敗，會迫使應用開發者不得不花費大量的精力排查故障並修覆，這在覆雜的工作流應用中尤為困難。

**異常處理機制**提供多樣化的節點錯誤處理策略，能夠在發生局部節點錯誤時拋出故障信息而不中斷主流程。你可以設置出現異常時重新執行節點，或通過備用路徑繼續任務。為關鍵節點**添加異常處理機制將極大地增強應用整體的靈活性與穩健性**。

*同時開啟錯誤重試和異常處理功能時，將優先重試運行節點。若重試後仍然失敗，再啟用異常處理機制。*


開發者無需在節點內編排覆雜的邏輯代碼或額外的節點應對錯誤情況。異常處理機制將簡化工作流的設計覆雜度，以多樣的預設策略編排工作流的執行邏輯。


[Arcade](https://app.arcade.software/share/g0ePRj5dA5WVv6noiPKX)


## 應用場景
1. 網絡異常處理

    示例：在某個工作流中需要通過三個 API 服務（例如天氣服務、新聞摘要和社交媒體分析）獲取數據並匯總。然而，其中一個服務因請求限制無法響應，導致數據獲取失敗。通過異常處理功能，主流程將繼續處理其它兩個成功的數據源，同時記錄失敗的 API 調用錯誤日志，供開發者稍後分析並優化服務調用策略。

2. 工作流備用設計

    示例：某個 LLM 節點執行生成詳細文檔摘要任務，但因輸入的篇幅過長而觸發超出 Token 限制的異常。在節點中配置異常錯誤機制後，出現此類錯誤時，可以使用備用路徑中的代碼節點協助將內容切分為多個小段並重新調用 LLM 節點，避免流程中斷。

3. 異常信息預定義

    示例：運行工作流時可能會遇到某個節點返回模糊的錯誤信息（例如簡單的“調用失敗”），難以快速定位問題。開發者可以通過異常處理機制內編寫預定義報錯信息，為後續的應用調試提供更加清晰、準確的錯誤信息。

## 異常處理機制

以下四個類型的節點新增異常處理機制，點擊標題即可閱讀詳細文檔：

- [LLM](https://docs.dify.ai/zh-hans/guides/workflow/node/llm)

- [HTTP](https://docs.dify.ai/zh-hans/guides/workflow/node/http-request)

- [代碼](https://docs.dify.ai/zh-hans/guides/workflow/node/code)

- [工具](https://docs.dify.ai/zh-hans/guides/workflow/node/tools)

## 異常重試

部分異常可以通過重新運行節點解決，此時可以在節點內開啟 **“異常重試”** 功能，設置嘗試次數與重試間隔時間。

![異常重試](/工作流/異常處理/images/異常重試.png)

如果嘗試重試運行節點後依然報錯，將按照異常處理機制中的預設策略運行接下來的流程。

異常處理

異常處理機制提供以下三種選項：

• 無：不處理異常，直接拋出節點的報錯信息並中斷整體流程。

• 默認值：允許開發者預定義異常信息。異常發生後，使用預定義的值替代原節點內置的異常輸出信息。

• 異常分支：發生異常後，執行預編排的異常分支

如需了解各個策略的說明和配置方法，請參考[預定義異常處理邏輯](https://docs.dify.ai/zh-hans/guides/workflow/error-handling/predefined-nodes-failure-logic)。